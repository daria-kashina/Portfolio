# Предсказание коэффициента восстановления золота из золотосодержащей руды

## Задача
Подготовить прототип модели машинного обучения: модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Нужно спрогнозировать сразу две величины:
1) Эффективность обогащения чернового концентрата rougher.output.recovery;
2) Эффективность обогащения финального концентрата final.output.recovery.

## Данные
Нам предоставлены данные по разным этапам технологического процесса: флотации, двухэтапной очистке и финальным характеристикам продукта. По каждому этапу предоставлены параметры сырья, параметры продукта, параметры, характеризующие текущее состояние этапа, расчетные характеристики. 

## Метрика качества
sMAPE (Symmetric Mean Absolute Percentage Error)

## Стек
matplotlib, pandas, pandas_profiling, phik, python, seaborn, sklearn

## Ход работы
### EDA и предобработка данных
   Проверка данных, характера распределений, пропусков, выбросов, попарной корреляции признаков. Проверка корректности расчета эффективности обогащения. Обработка пропусков и выбросов.
   Анализ изменения концентрации металлов на разных этапах очистки. Сравнение распределений размеров гранул на train и test. Исследование суммарной концентрации веществ на разных стадиях. 
### Вычисление sMAPE
   Написание функции для вычисления частного и взвешенного sMAPE.
### Обучение моделей
   Тюнинг гиперпараметров при помощи RandomizedSearchCV. Использование пайплайнов для стандартизации данных и тюнинга моделей. Рассмотрено три модели: LinearRegression, DecisionTreeRegressor, RandomForestRegressor. Выбор лучшей модели. Проверка адекватности модели при помощи константной модели DummyRegressor.

## Результат
   Для построения и выбора модели была выбрана метрика sMAPE - симметричное среднее абсолютное процентное отклонение. После оценки трех моделей: линейной регрессии, дерева решений и случайного леса, с учетом кросс-валидации (10 фолдов) во всех трех случаях, мы получили наилучший результат на модели случайного леса: итоговый sMAPE на обучающей выборке 9.547. Худший результат дала линейная регрессия - 10.6 на обучающей выборке. Мы проверили модель случайного леса на тестовой выборке и получили итоговый sMAPE 8.75 - лучше, чем на обучающей выборке, в связи с тем, что в test не так много данных, поэтому разброс меньше.


