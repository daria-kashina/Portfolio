# Анализ оттока клиентов банка

## Задача
По данным маркетологов сохранять текущих клиентов дешевле, чем привлекать новых. Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Необходимо построить модель с предельно большим значением F1-меры.
Дополнительно измерять AUC-ROC, сравнивать её значение с F1-мерой.

## Данные
Предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 

## Целевая метрика качества
F1>0.59

## Стек
imblearn, matplotlib, numpy, pandas, pandas_profiling, python, seaborn, sklearn

## Ход работы
### EDA и предобработка данных
   Проверка данных, статистик. Обработка пропусков, удаление ненужных столбцов. Разделение на обучающую и тестовую выборки. Исследование баланса классов.
### Обучение моделей
   Обучение моделей DesicionTree, RandomForest, LogisticRegression без учета дисбаланса классов. Тюнинг гиперпараметров при помощи RandomizedSearchCV. Использование пайплайнов для стандартизации числовых данных, кодирования категориальных признаков и тюнинга моделей. 
   
   Улучшение качества моделей с учетом дисбаланса классов. Использование апсемплинга SMOTE + подбор порога бинаризации категорий. Выбор и проверка лучшей модели.  
## Результат
   В ходе исследования различных моделей и дисбаланса классов мы получили наилучшее значение F1-меры на обучающей выборке для сбалансированной модели случайного леса: метрика F1 достигла 0.71 на обучающей выборке и 0.6241 на тестовой выборке. F1-мера показывает, как хорошо модель разобралась в особенностях положительного класса и распознала его (в нашем случае - как хорошо модель распознает, кто из клиентов ушел из банка), а также выявляет, не переусердствует ли модель, присваивая положительные метки. Метрика AUC-ROC для сбалансированной модели случайного леса оказалась равной 0.8617 - вероятность того, что клиент действительно ушел из банка. Для достижения таких значений метрик мы сбалансировали классы (сочетание гиперпараметра class_weight и апсемплинга SMOTE) и настроили порог бинаризации вероятности предсказаний - 0.58 для случайного леса.

